<!DOCTYPE html>

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Space+Mono&display=swap" rel="stylesheet">

<html lang="en" dir=ZgotmplZ>

<link href="https://github.com/VegaDeftwing" rel="me">

<link rel="webmention" href="https://webmention.io/opguides.info/webmention" />
<link rel="pingback" href="https://webmention.io/opguides.info/xmlrpc" />

<script src="/webmention.min.js" async></script>

<script src="/footnotes.js"> </script>
<script src="/keybed.js"> </script>
<script src="/js/egg.min.js"> </script>

<script>
  var egg = new Egg("d,e,v", function() {
    var elements = document.getElementsByClassName("egg");
    for(var i = 0; i < elements.length; i++) {
      elements[i].removeAttribute("hidden");
    }
  }).listen();
</script>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Chapter 17 - Optimization # If you&rsquo;re here, you&rsquo;re probably able to at least write some code. Is it perfect code? Probably not - but what code is.
Good code should be:
Malleable - You should be able to change it if requirements change. Simple - It should be easy to read Portable - It should be able to run almost everywhere Performant - It should go fast Unfortunately, those things are a bit at odds with each other.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark">







<style>
  a { color: #42b9f3; }
  a:active { color: #42b9f3; }
  ::-webkit-scrollbar-thumb { background: #009CDF !important; }
  .footnote-index { color: #42b9f3; }
</style>
<meta property="og:url" content="https://opguides.info/engineering/programming/optimization/">
  <meta property="og:site_name" content="Opinionated Guides">
  <meta property="og:title" content="Opinionated Guides">
  <meta property="og:description" content="Chapter 17 - Optimization # If you’re here, you’re probably able to at least write some code. Is it perfect code? Probably not - but what code is.
Good code should be:
Malleable - You should be able to change it if requirements change. Simple - It should be easy to read Portable - It should be able to run almost everywhere Performant - It should go fast Unfortunately, those things are a bit at odds with each other.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="engineering">
<title>Optimization | Opinionated Guides</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.35429f72a69cd687e5b8685a285d1d42c50d4ab26c9d7fec4aa5ce5ce35d1560.css" integrity="sha256-NUKfcqac1ofluGhaKF0dQsUNSrJsnX/sSqXOXONdFWA=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.31e691561b7b0671b76ff6a8027f0f9ec28a02a8545043c9f4c56b405766cbe5.js" integrity="sha256-MeaRVht7BnG3b/aoAn8PnsKKAqhUUEPJ9MVrQFdmy&#43;U=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  <script src="/sw-register.js"></script>
</head>

<body dir=ZgotmplZ>

        
        

        
        
        <script src="https://unpkg.com/@h0rn0chse/night-sky/dist/bundle.min.js"></script>
        

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "c6f9eeb56e4645ee9ca07afbee7e0462"}'></script>
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
        
  <nav>
<h2 class="book-brand">
  <a href="/"><img src="/nonfree/logo/opguide2.png" alt="Logo" id="logo" style="float: left; margin: 10px 10px 0px 0px;" /><span>Opinionated Guides</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  <div class="navbak" style="background:#009CDF;>
<ul>
<li><a href="/engineering/engineering/"><strong>Engineering</strong></a></li>
</ul>
</div>
<p class="navhead" style="color:#009CDF;margin-bottom:0px;" >    Introduction</p>
<div class="progress-ww">
<dl>
<dt>0 </dt><dd> <a href="/engineering/engineering/">What is this?</a></dd>
<dt>Ⅰ </dt><dd> <a href="/engineering/intro/community/">Community</a></dd>
<dt>Ⅱ </dt><dd> <a href="/engineering/intro/howtolearn/">Learn How to Learn</a></dd>
<dt>EXT</dt><dd> <a href="https://soatok.blog/2020/06/08/furward-momentum-introduction/">Furward Momentum</a></dd>
</dil>
</div>
<p class="navhead" style="color:#009CDF;margin-bottom:0px;" >    Linux & Your Computer</p>
<div class="progress-ww">
<dl>
<dt>1 </dt><dd> <a href="/engineering/linux/firstgoal/">The First Goal</a></dd>
<dt>2 </dt><dd> <a href="/engineering/linux/arch/">Installing Arch Linux</a></dd>
   <dt>3 </dt><dd> <details id="hardwareMenu"> <summary><a href="/engineering/linux/hardware/">Into The Hardware</a></summary>
    <dt class="sub">.1 </dt><dd class="sub"> <a href="/engineering/linux/hardware/cpu"> CPU</a></dd>
	  <dt class="sub">.2 </dt><dd class="sub"> <a href="/engineering/linux/hardware/ram"> RAM</a></dd>
    <dt class="sub">.3 </dt><dd class="sub"> <a href="/engineering/linux/hardware/motherboard"> Motherboard</a></dd>
    <dt class="sub">.4 </dt><dd class="sub"> <a href="/engineering/linux/hardware/gpu"> Graphics</a></dd>
    <dt class="sub">.5 </dt><dd class="sub"> <a href="/engineering/linux/hardware/storage"> Storage</a></dd>
    <dt class="sub">.6 </dt><dd class="sub"> <a href="/engineering/linux/hardware/network"> Networking</a></dd>
    <dt class="sub">.7 </dt><dd class="sub"> <a href="/engineering/linux/hardware/power"> Power</a></dd>
    <dt class="sub">.8 </dt><dd class="sub"> <a href="/engineering/linux/hardware/cooling"> Cooling</a></dd>
    <dt class="sub">.9 </dt><dd class="sub"> <a href="/engineering/linux/hardware/peripherals"> Peripherals</a></dd>
    <dt class="sub">.10</dt><dd class="sub"> <a href="/engineering/linux/hardware/biggerpicture"> The Bigger Picture</a></dd>
    <dt class="sub">.11</dt><dd class="sub"> <a href="/engineering/linux/hardware/buying"> What to Buy?</a></dd>
    <dt class="sub">.12</dt><dd class="sub"> <a href="/engineering/linux/hardware/legacy"> Legacy</a></dd>
   </details> </dd>
<dt>3½</dt><dd> <a href="/engineering/linux/hardware/architectures/">Architectures</a></dd>
<dt>4 </dt><dd> <a href="/engineering/linux/linuxdirtree/">Getting Rooted in Linux</a></dd>
<dt>5 </dt><dd> <a href="/engineering/linux/howwework/">Working on <i>How</i> we work</a></dd>
<dt>5½</dt><dd> <a href="/engineering/linux/git/">Git</a></dd>
<dt>A1</dt><dd> <a href="/engineering/linux/linuxshell/">Using The Linux Shell</a></dd>
<dt>A2</dt><dd> <a href="/engineering/linux/windows/">Ugh. Windows.</a></dd>
</dil>
</div>
<p class="navhead" style="color:#009CDF;margin-bottom:0px;" >    Prerequisites</p>
<div class="progress-ww">
<dl>
   <dt>6 </dt><dd> <details id="mathMenu"> <summary><a href="/engineering/math/math/">Math</a></summary>
    <dt class="sub">.1</dt><dd class="sub"> <a href="/engineering/math/algebra"> Algebra</a></dd>
	  <dt class="sub">.2</dt><dd class="sub"> <a href="/engineering/math/logic"> Logic</a></dd>
    <dt class="sub">.3</dt><dd class="sub"> <a href="/engineering/math/geometry"> Geometry & Trig</a></dd>
    <dt class="sub">.4</dt><dd class="sub"> <a href="/engineering/math/calc"> Calculus</a></dd>
    <dt class="sub">.5</dt><dd class="sub"> <a href="/engineering/math/diffeq"> Diff Eq</a></dd>
    <dt class="sub">.6</dt><dd class="sub"> <a href="/engineering/math/linalg"> Linear Algebra</a></dd>
    <dt class="sub">.7</dt><dd class="sub"> <a href="/engineering/math/numanalysis"> Numerical Analysis</a></dd>
    <dt class="sub">.8</dt><dd class="sub"> <a href="/engineering/math/settheory"> Set Theory</a></dd>
    <dt class="sub">.9</dt><dd class="sub"> <a href="/engineering/math/probability"> Probability</a></dd>
    <dt class="sub">.10</dt><dd class="sub"> <a href="/engineering/math/newmath"> New Math</a></dd>
   </details> </dd>
<dt>6½</dt><dd> <a href="/engineering/math/units/">Units</a></dd>
<dt>7 </dt><dd> <a href="/engineering/prereq/physics/">Physics</a></dd>
<dt>8 </dt><dd> <a href="/engineering/prereq/chem/">Chemistry</a></dd>
<dt>9 </dt><dd> <a href="/engineering/prereq/othersubjects/">'The Rest'</a></dd>
</dil>
</div>
<p class="navhead" style="color:#009CDF;margin-bottom:0px;" >    Programming</p>
<div class="progress-ww">
<dl>
<!--<dt>10 </dt><dd> <a href="/engineering/programming/codeintro/">Let's Write Some Code</a>-->
</dd>
    <dt>10 </dt><dd> <details id="codeMenu"> <summary><a href="/engineering/programming/intro/prog0intro">Let's Write Some Code</a></summary>
    <dt class="sub">.1 </dt><dd class="sub"> <a href="/engineering/programming/intro/prog1math"> It's Math?</a></dd>
	  <dt class="sub">.2 </dt><dd class="sub"> <a href="/engineering/programming/intro/prog2turtle"> Turtles!</a></dd>
    <dt class="sub">.3 </dt><dd class="sub"> <a href="/engineering/programming/intro/prog3tools"> Getting Tools</a></dd>
    <dt class="sub">.4 </dt><dd class="sub"> <a href="/engineering/programming/intro/prog4comments"> Knowing our Tools</a></dd>
    <dt class="sub">.5 </dt><dd class="sub"> <a href="/engineering/programming/intro/prog5two"> 2 for 1</a></dd>
    <dt class="sub">.6 </dt><dd class="sub"> <a href="/engineering/programming/intro/prog6types"> Types</a></dd>
    <dt class="sub">.7 </dt><dd class="sub"> <a href="/engineering/programming/intro/prog7logic"> logic & Functions</a></dd>
    <dt class="sub">.8 </dt><dd class="sub"> <a href="/engineering/programming/intro/prog8oo"> Data Structures</a></dd>
    <dt class="sub">.9 </dt><dd class="sub"> <a href="/engineering/programming/intro/prog9stdlib"> Libraries</a></dd>
    <dt class="sub">.10</dt><dd class="sub"> <a href="/engineering/programming/intro/prog10"> Rest of the Owl</a></dd>
    <dt class="sub">.11</dt><dd class="sub"> <a href="/engineering/programming/intro/progendreal"> Getting Real</a></dd>
   </details> </dd>
<dt>11 </dt><dd> <a href="/engineering/programming/bestpractices/">Best Practices</a></dd>
<dt>11½</dt><dd> <a href="/engineering/programming/ethics/">Ethics & Copyright</a></dd>
<dt>12 </dt><dd> <a href="/engineering/programming/lifeofcode/">Life Of Code</a></dd>
<dt>13 </dt><dd> <a href="/engineering/programming/fixxingissuses/">Fixing Issues</a></dd>
<dt>14 </dt><dd> <a href="/engineering/programming/lowlvl/">Low Level Programming</a></dd>
<dt>15 </dt><dd> <a href="/engineering/programming/algorithms/">Algorithms and More</a></dd>
<dt>15½</dt><dd> <a href="/engineering/programming/data/">Data is hard</a></dd>
<dt>16 </dt><dd> <a href="/engineering/programming/gitcicd/">Git, Testing, CI & CD</a></dd>
<dt>17 </dt><dd> <a href="/engineering/programming/optimization/"class=active>Optimization</a></dd>
<dt>18 </dt><dd> <a href="/engineering/programming/guiprog/">Graphical Programming</a></dd>
<dt>19 </dt><dd> <a href="/engineering/programming/shaders/">Shaders + GpGPU</a></dd>
<dt>20 </dt><dd> <a href="/engineering/programming/funcprog/">(((())(()((()(()))))))</a></dd>
<dt>21 </dt><dd> <a href="/engineering/programming/game/">Game Programming</a></dd>
<dl>
<dt>22 </dt><dd> <details id="compilersMenu"> <summary><a href="/engineering/programming/compilers/intro/">Custom Languages</a></summary>
	<dt class="sub">.1 </dt><dd class="sub"> <a href="/engineering/programming/compilers/prelude/"> Prelude</a></dd>
    <dt class="sub">.2 </dt><dd class="sub"> <a href="/engineering/programming/compilers/lexing/"> Lexing</a></dd>
    <dt class="sub">.3 </dt><dd class="sub"> <a href="/engineering/programming/compilers/parsing/"> Parsing</a></dd>
    <dt class="sub">.4 </dt><dd class="sub"> <a href="/engineering/programming/compilers/translation/"> Translation</a></dd>
    <dt class="sub">.5 </dt><dd class="sub"> <a href="/engineering/programming/compilers/generation/"> Code Generation</a></dd>
    <dt class="sub">.5 </dt><dd class="sub"> <a href="/engineering/programming/compilers/intermezzo/"> Intermezzo</a></dd>
    <dt class="sub">.6 </dt><dd class="sub"> <a href="/engineering/programming/compilers/commands/"> Commands</a></dd>
    <dt class="sub">.7 </dt><dd class="sub"> <a href="/engineering/programming/compilers/subroutines/"> Subroutines</a></dd>
    <dt class="sub">.8 </dt><dd class="sub"> <a href="/engineering/programming/compilers/conditionals/"> Conditionals</a></dd>
    <dt class="sub">.9 </dt><dd class="sub"> <a href="/engineering/programming/compilers/variables/"> Variables</a></dd>
    <dt class="sub">.10</dt><dd class="sub"> <a href="/engineering/programming/compilers/conclusion/"> Conclusion</a></dd>
   </details></dd>
</dil>
    <dt>A3 </dt><dd> <a href="/engineering/programming/languages/">Programming Languages</a></dd>
</div>
<p class="navhead" style="color:#009CDF;margin-bottom:0px;" >    Circuits</p>
<div class="progress-ww">
<dl>
    <dl>
<dt>23 </dt><dd> <details id="Circuits1Menu"> <summary><a href="/engineering/circuits/intro/1-intro/">Circuits!</a></summary>
	<dt class="sub">.1 </dt><dd class="sub"> <a href="/engineering/circuits/intro/2-tools/"> Tools</a></dd>
    <dt class="sub">.2 </dt><dd class="sub"> <a href="/engineering/circuits/intro/3-lcr/"> ⅏ ⟛ Ω</a></dd>
    <dt class="sub">.3 </dt><dd class="sub"> <a href="/engineering/circuits/intro/4-sim/"> Simulation</a></dd>
   </details></dd>
</dil>
<dt>24 </dt><dd> <a href="/engineering/circuits/circuits2/">Semiconductors</a></dd>
<dt>24½</dt><dd> <a href="/engineering/circuits/parts/">Parts</a></dd>
<dt>25 </dt><dd> <a href="/engineering/circuits/digitallogic/">Digital Logic</a></dd>
<dt>26 </dt><dd> <a href="/engineering/circuits/embedded/">Embedded Systems</a></dd>
<dt>27 </dt><dd> <a href="/engineering/circuits/pcb/">Let's Make our own PCB</a></dd>
</dil>
</div>
<p class="navhead" style="color:#009CDF;margin-bottom:0px;" >    Signal Processing</p>
<div class="progress-ww">
<dl>
<dt>28 </dt><dd> <a href="/engineering/signals/sigandsys">Signals & Systems</a></dd>
<dt>29 </dt><dd> <a href="/engineering/signals/commsys">Communications</a></dd>
<dt>30 </dt><dd> <a href="/engineering/signals/dsp">DSP</a></dd>
<dt>31 </dt><dd> <a href="/engineering/signals/controlsys">Control Systems</a></dd>
<dt>32 </dt><dd> <a href="/engineering/signals/compvision/">Computer Vision</a></dd>
<dt>33 </dt><dd> <a href="/engineering/signals/aiml/">Fine, here's AI/ML</a></dd>
</dil>
</div>
<p class="navhead" style="color:#009CDF;margin-bottom:0px;" >    Going Deeper</p>
<div class="progress-ww">
<dl>
<dt>34 </dt><dd> <a href="/engineering/deeper/compileassemble/">Compilers & Assemblers</a></dd>
<dt>35 </dt><dd> <a href="/engineering/deeper/reverse/">Reverse Engineering</a></dd>
<dt>36 </dt><dd> <a href="/engineering/deeper/fpga1/">Programmable Logic</a></dd>
<dt>37 </dt><dd> <a href="/engineering/deeper/comparch/">Let's Make our own CPU</a></dd>
<dt>37½</dt><dd> <a href="/engineering/deeper/nonsilicon/">Why Just Silicon?</a></dd>
</dil>
</div>
<p class="navhead" style="color:#009CDF;margin-bottom:0px;" >    Networking & Servers</p>
<div class="progress-ww">
<dl>
     <dt>38 </dt><dd> <details id="netMenu"> <summary><a href="/engineering/networking/networking/">Networking</a></summary>
    <dt class="sub">.1</dt><dd class="sub"> <a href="/engineering/networking/howyougothere"> How You Got Here</a></dd>
	  <dt class="sub">.2</dt><dd class="sub"> <a href="/engineering/networking/osi"> OSI</a></dd>
    <dt class="sub">.3</dt><dd class="sub"> <a href="/engineering/networking/tools"> Tools</a></dd>
   </details> </dd>
<dt>39 </dt><dd> <a href="/engineering/networking/servers/">Servers!</a></dd>
<dt>30½</dt><dd> <a href="/engineering/networking/cloud/">"The Cloud"</a></dd>
<dt>40 </dt><dd> <a href="/engineering/networking/databases/">Databases</a></dd>
<dt>41 </dt><dd> <a href="/engineering/networking/security/">Security & Exploitation</a></dd>
<dt>41½</dt><dd> <a href="/engineering/networking/privacy/">Privacy</a></dd>
</dil>
</div>
<p class="navhead" style="color:#009CDF;margin-bottom:0px;" >    Making & Hobbies</p>
<div class="progress-ww">
<dl>
<dt>42 </dt><dd> <a href="/engineering/making/3dprint/">3D Printing & CNC</a></dd>
<dt>43 </dt><dd> <a href="/engineering/making/hamradio/">Ham Radio</a></dd>
<dt>44 </dt><dd> <a href="/engineering/making/history/">Computer History</a></dd>
<dt>45 </dt><dd> <a href="/engineering/making/mechanical/">Mechanical</a></dd>
</dil>
</div>
<p class="navhead" style="color:#009CDF;margin-bottom:0px;" >    Wrapping Up</p>
<div class="progress-ww">
<dl>
<dt>46 </dt><dd> <a href="/engineering/wrappingup/wrappingup/">Where next?</a></dd>
<dt>A3 </dt><dd> <a href="/engineering/wrappingup/cheat/">Cheat Sheets & Libraries</a></dd>
<dt>A4 </dt><dd> <a href="/engineering/wrappingup/resources/">Other Great Resources</a></dd>
<dt>A5 </dt><dd> <a href="/engineering/wrappingup/job/">Getting a Job</a></dd>
<dt>A6 </dt><dd> <a href="/engineering/wrappingup/latex/">Markdown and LaTeX</a></dd>
</dil>
</div>
<hr>
<div class="navbak" style="background:#973999;">
<ul>
<li><strong>Music</strong></li>
</ul>
</div>
</div>
<div class="progress-ww">
<dl>
<dt>1 </dt><dd> <a href="/music/intro">Bang Zwoop Bada-dap-bap</a></dd>
<dt>2 </dt><dd> <a href="/music/gettingstarted/">Getting Started</a></dd>
<dt>3 </dt><dd> <a href="/music/gettingstartedcont/">On We Go</a></dd>
<dt>4 </dt><dd> <a href="/music/sound-sources/">Sound Sources</a></dd>
   <dt>5 </dt><dd> <details id="instMenu"> <summary><a href="/music/instruments/">Instruments</a></summary>
    <dt class="sub">.1</dt><dd class="sub"> <a href="/music/instruments/perc/"> Percussion</a></dd>
	  <dt class="sub">.2</dt><dd class="sub"> <a href="/music/instruments/strings/"> Strings</a></dd>
    <dt class="sub">.3</dt><dd class="sub"> <a href="/music/instruments/wind/"> Wind</a></dd>
    <dt class="sub">.4</dt><dd class="sub"> <a href="/music/instruments/synth/"> Synths</a></dd>
    <dt class="sub">.5</dt><dd class="sub"> <a href="/music/instruments/esoteric/"> The Esoteric</a></dd>
   </details> </dd>
   <dt>6 </dt><dd> <details id="effectMenu"> <summary><a href="/music/effects/">Effects</a></summary>
    <dt class="sub">.1</dt><dd class="sub"> <a href="/music/effects/trivial/"> Trivial Effects</a></dd>
	  <dt class="sub">.2</dt><dd class="sub"> <a href="/music/effects/time/"> Time Based Effects</a></dd>
    <dt class="sub">.3</dt><dd class="sub"> <a href="/music/effects/filter/"> Filters!</a></dd>
    <dt class="sub">.4</dt><dd class="sub"> <a href="/music/effects/dynamics/"> Dʸⁿᵃᵐᶦᶜˢ</a></dd>
    <dt class="sub">.5</dt><dd class="sub"> <a href="/music/effects/misc/"> Everything Else</a></dd>
<dt class="sub">.6</dt><dd class="sub"> <a href="/music/effects/meta/"> Meta</a></dd>
   </details> </dd>
<dt>7 </dt><dd> <a href="/music/seqandmidi/">Sequencing & MIDI</a></dd>
  </details> </dd>
   <dt>8 </dt><dd> <details id="softMenu"> <summary><a href="/music/software/music-software">Software</a></summary>
    <dt class="sub">.1</dt><dd class="sub"> <a href="/music/software/daw"> DAW?</a></dd>
	  <dt class="sub">.2</dt><dd class="sub"> <a href="/music/software/plugin/"> Plugins!</a></dd>
    <dt class="sub">.3</dt><dd class="sub"> <a href="/music/software/livecoding/"> Live Code</a></dd>
   </details> </dd>
<dt>8½</dt><dd> <a href="/music/midi/">MIDI in Detail</a></dd>
<dt>9 </dt><dd> <a href="/music/music-hardware/">Hardware</a></dd>
<dt>10 </dt><dd> <a href="/music/theory/">Theory</a></dd>
<dt>11 </dt><dd> <a href="/music/mix-and-master/">Mixing & Mastering</a></dd>
<dt>12 </dt><dd> <a href="/music/lyrics/">Lyrics</a></dd>
<dt>13 </dt><dd> <a href="/music/psychoacoustic/">Psychoacoustics</a></dd>
<dt>A1 </dt><dd> <a href="/music/other-resources-music/">Other Resources</a></dd>
<dt>A2 </dt><dd> <a href="/music/video/">Video</a></dd>
<dt>A3 </dt><dd> <a href="/music/vcv/">VCV Tips</a></dd>
<dt>A4 </dt><dd> <a href="/music/musicpiracy/">Piracy</a></dd>
</dil>
</div>
<hr>
<div class="navbak" style="background:#E23838;">
<ul>
<li><strong>Philosophy</strong></li>
</ul>
</div>
<div class="progress-ww">
<dl>
<dt>1 </dt><dd> <a href="/phil/basic-phil/">Basic Philosophy</a></dd>
<dt>2 </dt><dd> <a href="/phil/fallacies/">Logical Fallacies+</a></dd>
<dt>3 </dt><dd> <a href="/phil/arguments/">Arguments</a></dd>
<dt>4 </dt><dd> <a href="/phil/idea-labs/">Community Idea Labs</a></dd>
<dt>5 </dt><dd> <a href="/phil/community/">Community Efforts</a></dd>
<dt>6 </dt><dd> <a href="/phil/education/">Education</a></dd>
<dt>7 </dt><dd> <a href="/phil/labor/">Labor & Compensation</a></dd>
<dt>8 </dt><dd> <a href="/phil/copyright/">Copyright</a></dd>
<dt>9 </dt><dd> <a href="/phil/consumerism/">Consumerism</a></dd>
<dt>10 </dt><dd> <a href="/phil/law-and-order/">Law & Order</a></dd>
<dt>11 </dt><dd> <a href="/phil/infrastructure/">Infrasturcture</a></dd>
<dt>12 </dt><dd> <a href="/phil/environment/">Environment</a></dd>
<dt>13 </dt><dd> <a href="/phil/religion/">Religion</a></dd>
<dt>14 </dt><dd> <a href="/phil/sex/">Sex</a></dd>
<dt>15 </dt><dd> <a href="/phil/medical/">Medical</a></dd>
<dt>16 </dt><dd> <a href="/phil/foriegn/">Foriegn Involvement</a></dd>
<dt>17 </dt><dd> <a href="/phil/voting/">Voting</a></dd>
<dl>
   <dt>18 </dt><dd> <details id="freedomMenu"> <summary><a href="/phil/freedoms/freedoms/">Freedoms</a></summary>
    <dt class="sub">.1 </dt><dd class="sub"> <a href="/phil/freedoms/speech/"> Speech</a></dd>
	<dt class="sub">.2 </dt><dd class="sub"> <a href="/phil/freedoms/press/"> Press</a></dd>
    <dt class="sub">.3 </dt><dd class="sub"> <a href="/phil/freedoms/search/"> Search & Seizure</a></dd>
    <dt class="sub">.4 </dt><dd class="sub"> <a href="/phil/freedoms/fairtrial/"> Fair Trial</a></dd>
    <dt class="sub">.5 </dt><dd class="sub"> <a href="/phil/freedoms/body/"> Bodily Autonomy</a></dd>
    <dt class="sub">.6 </dt><dd class="sub"> <a href="/phil/freedoms/environmentalconcern/"> Environment</a></dd>
    <dt class="sub">.7 </dt><dd class="sub"> <a href="/phil/freedoms/travel/"> Travel</a></dd>
    <dt class="sub">.8 </dt><dd class="sub"> <a href="/phil/freedoms/armament/"> Armament</a></dd>
    <dt class="sub">.9 </dt><dd class="sub"> <a href="/phil/freedoms/recording/"> Recording</a></dd>
    <dt class="sub">.10</dt><dd class="sub"> <a href="/phil/freedoms/ownership"> Ownership</a></dd>
    <dt class="sub">EXT</dt><dd class="sub"> <a href="https://anewdigitalmanifesto.com"> Digital Manifesto</a></dd>
   </details> </dd>
<dt>19 </dt><dd> <a href="/phil/duties/">Duties</a></dd>
<dt>20 </dt><dd> <a href="/phil/phil-and-the-internet/">Internet</a></dd>
<dt>21 </dt><dd> <a href="/phil/economics/">Economics</a></dd>
<dt>22 </dt><dd> <a href="/phil/history/">History</a></dd>
<dt>21 </dt><dd> <a href="/phil/phil-misc/">Misc</a></dd>
<dt>A1 </dt><dd> <a href="/phil/phil-other/">Other Resources</a></dd>
</dil>
</div>
<hr>
<div class="navbak" style="background:#F78200;">
<ul>
<li><strong>Design</strong></li>
</ul>
</div>
<div class="progress-ww">
<dl>
<dt>EXT</dt><dd> <a href=https://www.youtube.com/watch?v=5Tx6U5OhMDg&list=PL6haVw-BFETw13kBFhbWl6UCshzgIC7Ea> Catastrovtivity </a></dd>
<dt>1 </dt><dd> <a href="/design/basics/">Basics of Art</a></dd>
<dt>1½</dt><dd> <a href="/design/vbasics/">Basics++</a></dd>
<dt>2 </dt><dd> <a href="/design/analog/">Analog Art</a></dd>
<dt>3 </dt><dd> <a href="/design/digital/">Digital Art</a></dd>
<dt>3½</dt><dd> <a href="/design/dacadc/">DAC/ADC</a></dd>
<dt>4 </dt><dd> <a href="/design/ui/">UI/UX</a></dd>
<dt>5 </dt><dd> <a href="/design/3d/">3D</a></dd>
<dt>6 </dt><dd> <a href="/design/gen/">Generative Tools</a></dd>
<dt>7 </dt><dd> <a href="/design/animation/">Animation</a></dd>
<dt>A1 </dt><dd> <a href="/design/design-other/">Other Resources</a></dd>
<dt>A2 </dt><dd> <a href="/design/ia/">Inspirational Art</a></dd>
<dt>A3 </dt><dd> <a href="/design/photo/">Photo</a></dd>
</dil>
</div>
<p class="navhead, webhead" style="background: linear-gradient(90deg, #F78200 0%, #FFF 50%, #009CDF 75%) ;-webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom:0px;" >    Web Development</p>
</div>
<div class="progress-ww">
<dl>
<dt>1 </dt><dd> <a href="/design/web/jack/">Jack of all trades</a></dd>
<dt>2 </dt><dd> <a href="/design/web/garden/">Your own garden</a></dd>
</details> </dd>
   <dt>3 </dt><dd> <details id="webMenu"> <summary><a href="/design/web/langs">HTML, CSS, JS, WUT?</a></summary>
    <dt class="sub">.1</dt><dd class="sub"> <a href="/design/web/langs/html/"> HTML</a></dd>
	  <dt class="sub">.2</dt><dd class="sub"> <a href="/design/web/langs/css/"> CSS</a></dd>
    <dt class="sub">.3</dt><dd class="sub"> <a href="/design/web/langs/js/"> JS</a></dd>
   </details> </dd>
<dt>4 </dt><dd> <a href="/design/web/static/">Static & Dynamic</a></dd>
<dt>5 </dt><dd> <a href="/design/web/cost/">Cost?</a></dd>
<dt>6 </dt><dd> <a href="/design/web/setup/">Getting Setup</a></dd>
<dt>7 </dt><dd> <a href="/design/web/content/">Content is King</a></dd>
<dt>8 </dt><dd> <a href="/design/web/thinkingweb/">Thinking Web</a></dd>
<dt>8½</dt><dd> <a href="/design/web/access/">Accessability</a></dd>
<dt>A1 </dt><dd> <a href="/design/web/tools/">Web development tools</a></dd>
<dt>A2 </dt><dd> <a href="/design/web/resources/">Other Resources</a></dd>
</dil>
</div>
<hr>
<div class="navbak" style="background:#FFB900;">
<ul>
<li><strong>Interviews</strong></li>
</ul>
</div>
<div class="progress-ww">
<dl>
<dt> </dt><dd> <a href="/interviews/loial/">Loial Otter</a></dd>
<dt> </dt><dd> <a href="/interviews/soatok/">Soatok Dreamseeker</a></dd>
<dt> </dt><dd> <a href="/interviews/cadeyratio/">Cadey Ratio</a></dd>
<dt> </dt><dd> <a href="/interviews/kell/">Kell Bengal</a></dd>
<dt> </dt><dd> <a href="/interviews/taxbadger/">Tax Badger</a></dd>
<dt> </dt><dd> <a href="/interviews/spg/">Sex Positive Gaming</a></dd>
<dt> </dt><dd> <a href="/interviews/cendyne/">Cendyne</a></dd>
<dt> </dt><dd> <a href="/interviews/wolfgun/">Wolfgun</a></dd>
<dt> </dt><dd> <a href="/interviews/paulshapera/">Paul Shapera</a></dd>
</dil>
</div>
<hr>
<div class="navbak" style="background:#5EBD3E;">
<ul>
<li><strong>Other</strong></li>
</ul>
</div>
<div class="progress-ww">
<dl>
<dt> </dt><dd> <a href="/other/funlinks/">Interesting Links</a></dd>
<dt> </dt><dd> <a href="/other/advice/">Advice</a></dd>
<p class="navhead" style="color:#5EBD3E;margin-bottom:0px;" >   Technical</p>
<dt></dt><dd>
      <details id="hciMenu"> <summary> <a href="/other/hci2/intro/">The Way We Interact With Computers Sucks</a></summary>
         <dt class="sub">1</dt><dd class="sub"> <a href="/other/hci2/physical"> The Physical</a></dd>
	      <dt class="sub">2</dt><dd class="sub"> <a href="/other/hci2/digital"> The Digital</a></dd>
         <dt class="sub">3</dt><dd class="sub"> <a href="/other/hci2/whatelse"> What Is Needed?</a></dd>
         <dt class="sub">4</dt><dd class="sub"> <a href="/other/hci2/contradictions"> What Contradicts?</a></dd>
         <dt class="sub">5</dt><dd class="sub"> <a href="/other/hci2/radicallychanging"> Radically Changing</a></dd>
         <dt class="sub">6</dt><dd class="sub"> <a href="/other/hci2/wrappingup"> Wrapping Up</a></dd>
      </details>
</dd>
<dt> </dt><dd> <a href="/other/coolhardware/">Cool Hardware</a></dd>
<dt> </dt><dd> <a href="/other/fediverse/">The Fediverse, ActivityPub, & The IndieWeb </a></dd>
<p class="navhead" style="color:#5EBD3E;margin-bottom:0px;" >   Conlangs & Neography</p>
    <dt> </dt><dd> <a href="/other/conlangs/neography/">Intro to Conlangs & Neography</a></dd>
	<dt> </dt><dd> <a href="/other/conlangs/tokipona/">toki pona! <span class="conlang">󱥬󱦖󱥔</span> </a></dd>
    <dt> </dt><dd> <a href="/other/conlangs/janolin/">Thoughts on olin</a> <span style="font-size:.4rem;">by jan Usawi</span>
    <dt> </dt><dd> <a href="/other/conlangs/rhapsodaic/">Rhapsodaic</a> <span style="font-size:.4rem;">by jan Usawi</span></dd>
<!--
<dt> </dt><dd> <a href="/other/conlangs/neography/">Neography </a></dd>
<dt> </dt><dd> <a href="/other/conlangs/rhapsodaic/">Rhapsodaic </a></dd>
<p class="navhead" style="color:#5EBD3E;margin-bottom:0px;" >   Writing & Storytelling</p>
<dt>1 </dt><dd> <a href="/other/writing/writing">Writing is hard</a></dd>
<dt>1½</dt><dd> <a href="/other/writing/creative">Creative Thinking</a></dd>
<dt>2 </dt><dd> <a href="/other/writing/plot">Plot & Pacing</a></dd>
<dt>3 </dt><dd> <a href="/other/writing/conflict">Conflict</a></dd>
<dt>4 </dt><dd> <a href="/other/writing/characters">Characters</a></dd>
<dt>5 </dt><dd> <a href="/other/writing/language">Language</a></dd>
<dt>6 </dt><dd> <a href="/other/writing/worldbuilding">World Building</a></dd>
<dt>7 </dt><dd> <a href="/other/writing/revision">Revision</a></dd>
<dt>A1</dt><dd> <a href="/other/writing/poetry">Poetry</a></dd>
--->
</dil>
</div>
<hr>
<div class="navbak" style="background: linear-gradient(60deg, #f79533, #f37055, #ef4e7b, #a166ab, #5073b8, #1098ad, #07b39b, #6fba82);animation: animatedgradient 5s ease alternate infinite;background-size: 300% 300%;">
<ul>
<li><b><a href="/posts/" style="color: #000 !important;">Blog<a></b></li>
</ul>
</div>

<div style="width: 90%;margin: auto;">
        
          
            <dl>
                <li class="flex justify-between">
                    <dd><b><a href="/tags/">TAG</a></b><dt>
                    <b><dd class="blogdd" style="color: #fff;">№ of Posts</dt></b>
                  </li>
                  <hr>
            
              <li class="flex justify-between">
                <dd><a href="/tags/music/">Music</a><dt>
                <dd class="blogdd" style="color: #fff;">2</dt>
              </li>
            
              <li class="flex justify-between">
                <dd><a href="/tags/meta/">Meta</a><dt>
                <dd class="blogdd" style="color: #fff;">3</dt>
              </li>
            
              <li class="flex justify-between">
                <dd><a href="/tags/language/">Language</a><dt>
                <dd class="blogdd" style="color: #fff;">1</dt>
              </li>
            
              <li class="flex justify-between">
                <dd><a href="/tags/personal/">Personal</a><dt>
                <dd class="blogdd" style="color: #fff;">10</dt>
              </li>
            
              <li class="flex justify-between">
                <dd><a href="/tags/technical/">Technical</a><dt>
                <dd class="blogdd" style="color: #fff;">11</dt>
              </li>
            
              <li class="flex justify-between">
                <dd><a href="/tags/art/">Art</a><dt>
                <dd class="blogdd" style="color: #fff;">3</dt>
              </li>
            
              <li class="flex justify-between">
                <dd><a href="/tags/school/">School</a><dt>
                <dd class="blogdd" style="color: #fff;">2</dt>
              </li>
            
              <li class="flex justify-between">
                <dd><a href="/tags/politics/">Politics</a><dt>
                <dd class="blogdd" style="color: #fff;">2</dt>
              </li>
            
            </dil>
          </li>
          
        
</div>
<br />









</nav>




  <script>document.addEventListener("DOMContentLoaded",function(){var n=localStorage.getItem("storedScrollTop"),t=document.querySelector("body > main > aside.book-menu > nav");console.log("Menu after DOM element:",t),t.scrollTop=n}),window.onbeforeunload=function(){var t=document.querySelector("body > main > aside.book-menu > nav");console.log("Menu bufore unload element:",t),localStorage.setItem("storedScrollTop",t.scrollTop)}</script>


 
    </aside>

    <div class="book-page">
      
      
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Optimization</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#chapter-17---optimization">Chapter 17 - Optimization</a>
      <ul>
        <li><a href="#finding--profiling-code">Finding &amp; Profiling Code</a></li>
        <li><a href="#thinking-about-our-data">Thinking about our data</a></li>
        <li><a href="#making-multiple-things-execute-at-once">Making Multiple Things Execute at Once</a></li>
        <li><a href="#offloading-processing">Offloading Processing</a></li>
        <li><a href="#taking-full-advantage-of-our-cores">Taking Full Advantage of our Cores</a></li>
        <li><a href="#using-threads-to-wait-on-io">Using Threads To Wait On I/O</a></li>
        <li><a href="#simd">SIMD</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="chapter-17---optimization">
  Chapter 17 - Optimization
  <a class="anchor" href="#chapter-17---optimization">#</a>
</h1>
<p>If you&rsquo;re here, you&rsquo;re probably able to at least write some code. Is it perfect code? Probably not - but what code is.</p>
<p>Good code should be:</p>
<ul>
<li>Malleable - You should be able to change it if requirements change.</li>
<li>Simple - It should be easy to read</li>
<li>Portable - It should be able to run <em>almost</em> everywhere</li>
<li>Performant - It should go fast</li>
</ul>
<p>Unfortunately, those things are a bit at odds with each other. Hyper-optimized, fast code often requires breaking though layers of abstractions and doing things in ways that are far from simple, making assumptions about what hardware it will be running on, and using subtle details to eek out extra performance - trading knowledge about how the code will run under the current understanding with flexibility should the requirements change.</p>
<p>All of this is to say, while optimization for speed can be important, it comes at more cost than just the time it takes to write fast code. It will make your code harder to read.</p>
<p>Still, there are situations where a certain performance level becomes absolutely necessary and changes must be made to accommodate it.</p>
<p>I like to divide performance problems into two categories either your program is <strong>overworked</strong> or <strong>very board</strong></p>
<p>If your program is <strong>overworked</strong>, it&rsquo;s chugging though as much data as it can but either there&rsquo;s a lot of data or the computation on that data is very heavy, so it&rsquo;ll just take a long time to complete. An impractical example here would be computing very high digits of pi.</p>
<p>If your program is <strong>very board</strong> it&rsquo;s because it&rsquo;s spending the majority of its time doing nothing other than waiting on something else to happen. Almost always, this is I/O. Waiting on a user to press a button, waiting for data to finish being sent over a slow interface, waiting to read data from a file stored on hard drive, etc.</p>
<p>For <strong>overworked</strong> code we have a lot of options, depending on the specifics of the problem</p>
<ul>
<li>You can try to find a better algorithm for the hot-spot(s) in our logic</li>
<li>You might be able to split up the work load across multiple cores
<ul>
<li>In extreme case, you might even be able to offload the work to the GPU or other hardware</li>
</ul>
</li>
<li>You might be able to take advantage of the specific architecture you&rsquo;re running on, such as using <a href="https://en.wikipedia.org/wiki/Single_instruction,_multiple_data">SIMD</a> instructions</li>
<li>You might be able to pre-process the data to avoid unnecessary work</li>
<li>You might be able to use <a href="https://en.wikipedia.org/wiki/Memoization">memoization</a> to cache past results to make future calls faster</li>
<li>You might be able to use only slightly less accurate approximations of math functions</li>
</ul>
<p>For a <strong>very board</strong> program, you really want to find the thing that&rsquo;s blocking you and have it run on it&rsquo;s own thread/task/core.</p>
<p>As a contrived example, imagine a word processor written like this (this isn&rsquo;t a real language, just pseudo code)</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">while</span>(<span style="color:#66d9ef">True</span>){
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Wait for input character</span>
</span></span><span style="display:flex;"><span>    buffer <span style="color:#f92672">+=</span> get_character()
</span></span><span style="display:flex;"><span>    pos<span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># We must&#39;ve finished a word, see if the last word is</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># spelled correctly</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (new_char <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34; &#34;</span>) {
</span></span><span style="display:flex;"><span>        word <span style="color:#f92672">=</span> buffer[last_new_word_pos:pos]
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Spell checking takes a while, as we have to check if</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># the word is in the dictonary</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(spell_check(word) <span style="color:#f92672">==</span> BAD_SPELLING){
</span></span><span style="display:flex;"><span>            red_underline(word)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        last_new_word_pos <span style="color:#f92672">=</span> pos
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Display the buffer</span>
</span></span><span style="display:flex;"><span>    display(buffer)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>This would be immensely frustrating to use because every time you press space, the entire program would hang for a moment to spell check. If <code>get_character()</code> were written poorly, it may even miss input characters while it does this.</p>
<style>
.err {
    text-decoration-line: underline;
	text-decoration-style: wavy;
    text-decoration-color: red;
}
</style>
<p>The right way to do this would be to have three separate tasks:</p>
<ul>
<li>One that constantly gets user input and buffers it, waiting for the others to ask for it</li>
<li>One that takes the buffer and displays it on the screen (showing data on the screen is also slow)</li>
<li>One that looks at the global buffer and spell and grammar checks periodically, informing the display task if the text needs to show a red <span class="err">squigggle</span></li>
</ul>
<p>By doing it like this, we will never loose user input due to the spell checker running, we don&rsquo;t have to process things word by word anymore (giving us better spelling and grammar checking), and the user shouldn&rsquo;t feel a weird lag between typing a character and it showing up even if we add other systems that decorate or act on the text.</p>
<p>Putting this all together, regardless of it&rsquo;s overworked or very bored code we need to know:</p>
<ol>
<li>How to find the problematic code</li>
<li>How to profile the problematic code</li>
</ol>
<p>So that we can try</p>
<ul>
<li>Reducing the amount of data we&rsquo;re processing</li>
<li>Reducing the amount of processing we&rsquo;re doing on the data</li>
<li>Making multiple things execute at once</li>
<li>Offloading processing to other hardware</li>
<li>Taking full advantage of each CPU core</li>
</ul>
<h2 id="finding--profiling-code">
  Finding &amp; Profiling Code
  <a class="anchor" href="#finding--profiling-code">#</a>
</h2>
<ol>
<li>How to find the problematic code</li>
<li>How to profile the problematic code</li>
</ol>
<h2 id="thinking-about-our-data">
  Thinking about our data
  <a class="anchor" href="#thinking-about-our-data">#</a>
</h2>
<ul>
<li>Reducing the amount of data we&rsquo;re processing</li>
<li>Reducing the amount of processing we&rsquo;re doing on the data</li>
</ul>
<h2 id="making-multiple-things-execute-at-once">
  Making Multiple Things Execute at Once
  <a class="anchor" href="#making-multiple-things-execute-at-once">#</a>
</h2>
<p>Multi-processing and multi-threading code is both a bit complicated to write and a total mess of terminology. So, let&rsquo;s start by at least getting our terminology straight.</p>
<p>If you want to have multiple things run at the same time (or at least look like they are, if you only have 1 core) you generally have a few options:</p>
<ol>
<li>Run multiple processes which communicate with each other</li>
<li>Have one process with multiple threads</li>
</ol>
<p>You probably already have a rough idea of the difference between a thread and process, but in short:</p>
<ul>
<li>Threads are cheaper to pass data between and cheaper to create and destroy</li>
<li>Threads are <em>typically</em> a bit easier to work with</li>
<li>Processes are isolated, which can be good for avoiding one spying on another (security)
<ul>
<li>This is literally the same as you running your program twice and giving both copies some way to talk.</li>
</ul>
</li>
<li>Running multiple separate processes might give you more performance than threads</li>
<li>You can run multiple processes, each with multiple threads</li>
</ul>
<p>This all gets more-than-a-little fuzzy, because in some languages and systems, a process which is running multiple threads may be able to run those threads at <em>literally</em> the same time while in others it may only be able to time-divide such that your code can appear to be doing multiple things at once.</p>
<p>This distinction of thread types depends on if the threading system being used has threads provided by some scheduler that lives in the program itself (&quot;<a href="https://en.wikipedia.org/wiki/Green_thread">Green threads&quot;</a>) or by the operating system kernel, and you&rsquo;ll probably have to do some research into the specific threading library for the language you want to use to figure out which it is.</p>
<p>The difference <strong>does matter</strong>. If you&rsquo;re using &ldquo;real&rdquo; kernel level threads and you don&rsquo;t need the per-process isolation, there&rsquo;s not really a good reason to try to spawn multiple threads with multiple processes - you&rsquo;ll already be able to take advantage of all the CPU cores on your system. Note though, doing those system calls to the kernel level thread scheduler is a hair slower than what green threads can achieve if you&rsquo;re only going to be running on one core anyway.</p>
<p>There&rsquo;s also some systems (like Goroutines in the Go programming language) where the user-space scheduler will dispatch threads to the kernel level one at times providing a sort of hybrid approach, presumably giving you the best of both worlds - similar to using multiple green threads on multiple processes.</p>
<blockquote>
<p>As I lack a better place to talk about it: There are also &ldquo;<a href="https://en.wikipedia.org/wiki/Coroutine">Coroutines</a>&rdquo;, which have a rather fuzzy definition, but generally the difference is that while threads will preempt each other - that is, the OS or Scheduler will not let one thread sit there and hog all the processor time - coroutines are cooperative, they depend on one-another saying &ldquo;Hey, I need to wait on something for a bit so I&rsquo;m <code>yield()</code>ing&rdquo;. Importantly, this system makes sense because it&rsquo;s only one one thread/processes - it is not trying to run things at the same time, only give up control to another function if it doesn&rsquo;t have anything to do.</p>
<p>If you see something about &ldquo;<a href="https://en.wikipedia.org/wiki/Protothread">prototheads</a>&rdquo; it&rsquo;s basically just a fancy coroutine.</p>
</blockquote>
<p>Finally, we need to talk about a few terms relating to how these threads or processes talk.</p>
<p>If you&rsquo;re using different processes (not threads!), they need some way to communicate data other than directly with shared address space because, well, they no longer share address space. This is <a href="https://en.wikipedia.org/wiki/Inter-process_communication"><strong>I</strong>nter-<strong>P</strong>rocess <strong>C</strong>ommunication</a>, or IPC. That Wikipedia page is actually great for listing the the different ways it can be done.</p>
<p>If you&rsquo;re using threading, it&rsquo;s common that the language you&rsquo;re using provides some sort of asynchronous, usually abbreviated &ldquo;async&rdquo; programming model. For example, <a href="https://docs.python.org/3/library/asyncio-task.html">Python&rsquo;s <code>asyncio</code></a>, <a href="https://rust-lang.github.io/async-book/01_getting_started/02_why_async.html">Rust&rsquo;s async</a>, etc.</p>
<p>Reading those pages will do a lot more good than me trying to poorly summarize them here, so I recommend taking a look at both to get a feel fro what async models are good at. Even if you don&rsquo;t use Rust or Python, the general idea is available in many, many languages now.</p>
<p>Now, this is where things get actually gross: As soon we have multiple things running at once, we can have a whole host of problems and solutions to them.</p>
<ul>
<li><strong>Race Conditions</strong> occur when two things try to acquire (and do) access to something only one thing should be able to do at once. For example, if two threads are trying to increment a variable, they have to first read it, add to it, and then write it. [TODO Finish this example]</li>
<li>Code that has things where only one thing should be able to do anything at a time is called a <strong>critical section</strong>.</li>
<li>To avoid these problems, we usually use a <strong>lock</strong> (often called a <strong>mutex</strong>) of some sort or a <strong>semaphore</strong>. A lock does what it sounds like, it says, &ldquo;I&rsquo;m entering this critical section, nobody else can use it right now&rdquo; - like a public restroom. A semaphore is more-or-less the same thing, but you say I have N of this thing available - keeping the restroom analogy, say N stalls, and each time someone needs one they <code>wait()</code> for it, each time someone exits they <code>post()</code> that they exited. Really a lock is just a semaphore with 1 of the resource to go around. Importantly, for each semaphores, the process/task waiting doesn&rsquo;t care which copy of the resource (which stall) it gets, just that it gets one.</li>
<li>A <strong>deadlock</strong> occurs if everybody is waiting on everbody else do something - usually releasing a lock.</li>
<li>If something happens &ldquo;<strong>Atomically</strong>&rdquo; (or is forced to do so) it meas that only one thing can act on it at once, everybody else will be forced to wait because that resource can&rsquo;t be shared. The message passing structures in an application are usually made to be atomic. Atomicity is often enforced by using a special atomic instruction that does the <a href="https://en.wikipedia.org/wiki/Read%E2%80%93modify%E2%80%93write">Read-modify-write</a> of a variable all in one-shot.</li>
</ul>
<p>Finally, it&rsquo;s worth noting that there are some design patterns that are pretty common.</p>
<ul>
<li><strong>Producer(s) &amp; Consumer(s)</strong>:  some task(s)/process(s) make work, the others do it. This is often done with a queue of data to be done, which must be atomic - even though the production and and consumption of that work doesn&rsquo;t have to be. Sometimes this queue is called a <strong>mailbox</strong>.</li>
</ul>
<p>[TODO]: Actually examples of Threading, multi-processing, etc.</p>
<h2 id="offloading-processing">
  Offloading Processing
  <a class="anchor" href="#offloading-processing">#</a>
</h2>
<h2 id="taking-full-advantage-of-our-cores">
  Taking Full Advantage of our Cores
  <a class="anchor" href="#taking-full-advantage-of-our-cores">#</a>
</h2>
<h4><span class="best ">
    <img src="/nonfree/logo/best.svg" width="20em" style="margin: -10px 0px 0px 0px; margin-bottom: -10px;"/>
    <a href="https://en.algorithmica.org/hpc/">Algorithms For Modern Hardware</a>
</span></h4>
<p>I can not do better than this book with the time I am willing to devote to this page. This book is approachable, well explained, and generally written from a place of more experience than I have. I do have some commentary, but, seriously, read this. Come back and we&rsquo;ll discuss after</p>
<hr>
<p>Additional resources on SIMD:</p>
<p><a href="https://nullprogram.com/blog/2021/12/04/">Fast CSV Processing with SIMD (null program)</a></p>
<h2 id="using-threads-to-wait-on-io">
  Using Threads To Wait On I/O
  <a class="anchor" href="#using-threads-to-wait-on-io">#</a>
</h2>
<p>[TDOO] Motivations from Moore&rsquo;s law, Blocking I/O,</p>
<p>[TODO] start with process forking via syscall - show it</p>
<p><a href="https://lemire.me/blog/2020/01/30/cost-of-a-thread-in-c-under-linux/">https://lemire.me/blog/2020/01/30/cost-of-a-thread-in-c-under-linux/</a></p>
<p>C++ coroutines</p>
<p>not really threading, but process children</p>
<h2 id="simd">
  SIMD
  <a class="anchor" href="#simd">#</a>
</h2>
<p>[TODO] Compiler options, using intinsics, pragmas, etc.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">
  
  
  
  
  
    <div>
      <a class="flex align-center" href="https://github.com/VegaDeftwing/OpGuidesHugoSrc/tree/main/content//Engineering/Programming/optimization.md" target="_blank" rel="noopener">
        <img src="/svg/edit.svg" class="book-icon" alt="Edit" />
        <span>Edit this page</span>
      </a>
    </div>
  
  </div>
  
  <hr/>
  <span><a href="https://webring.xxiivv.com/#random" target="_blank"><img id="webring-img" src="https://webring.xxiivv.com/icon.white.svg" style="width:100px;height:100px;opacity: .7;"/></a> </span>
  <p>If you would like to support my development of OpGuides, please consider supporting me on <a href="https://github.com/sponsors/VegaDeftwing">GitHub Sponsors</a> or dropping me some spare change on Venmo @vegadeftwing - every little bit helps ❤️</p>
  </footer>
  
  <div id="webmentions"></div>
  
 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#chapter-17---optimization">Chapter 17 - Optimization</a>
      <ul>
        <li><a href="#finding--profiling-code">Finding &amp; Profiling Code</a></li>
        <li><a href="#thinking-about-our-data">Thinking about our data</a></li>
        <li><a href="#making-multiple-things-execute-at-once">Making Multiple Things Execute at Once</a></li>
        <li><a href="#offloading-processing">Offloading Processing</a></li>
        <li><a href="#taking-full-advantage-of-our-cores">Taking Full Advantage of our Cores</a></li>
        <li><a href="#using-threads-to-wait-on-io">Using Threads To Wait On I/O</a></li>
        <li><a href="#simd">SIMD</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>
  
</body>
</html>












